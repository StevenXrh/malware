import configparser
import MySQLdb

class database_utils():

    def __init__(self):

        config_select = 'DB_utils_config'
        self.conf = configparser.ConfigParser()
        self.conf.read('D:\malware\config.ini')
        self.DB = self.conf.get(config_select, 'DBNAME')
        self.HOST =self.conf.get(config_select,'DBHOST')
        self.DBUSER =self.conf.get(config_select,'DBUSER')
        self.DBPWD =self.conf.get(config_select,'DBPWD')
        self.DBCHARSET =self.conf.get(config_select,'DBCHARSET')
        self.DBPORT =self.conf.getint(config_select,'DBPORT')

    def getCon(self):
        try:
            conn = MySQLdb.connect(host=self.HOST,
                                   user=self.DBUSER,
                                   passwd=self.DBPWD,
                                   db=self.DB,
                                   port=self.DBPORT,
                                   charset=self.DBCHARSET)
            return conn
        except MySQLdb.Error as e:
            print ("Mysqldb Errorr" %e)

